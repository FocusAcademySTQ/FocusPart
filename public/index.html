<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8">
  <title>Login - Gesti√≥ Classes</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 h-screen flex items-center justify-center font-sans">
  <div class="bg-white p-6 rounded shadow w-80">
    <h1 class="text-xl font-bold mb-4">üîê Inicia sessi√≥</h1>
    <form id="loginForm" class="space-y-3">
      <input type="text" id="usuari" placeholder="Usuari" class="w-full border p-2 rounded" required>
      <input type="password" id="contrasenya" placeholder="Contrasenya" class="w-full border p-2 rounded" required>
      <button type="submit" class="w-full bg-blue-500 text-white py-2 rounded">Entrar</button>
    </form>
    <p id="msg" class="text-red-500 mt-3"></p>
  </div>
  <script>
    document.getElementById("loginForm").addEventListener("submit",async e=>{
      e.preventDefault();
      const usuari=document.getElementById("usuari").value.trim();
      const contrasenya=document.getElementById("contrasenya").value.trim();
      const res=await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({usuari,contrasenya})});
      const data=await res.json();
      if(res.ok){
        if(data.role==="admin"){
          localStorage.removeItem("profe");
          localStorage.setItem("admin",JSON.stringify(data));
          window.location.href="admin.html";
        }else{
          localStorage.removeItem("admin");
          localStorage.setItem("profe",JSON.stringify(data));
          window.location.href="profe.html";
        }
      }else{
        document.getElementById("msg").textContent="‚ùå "+data.error;
      }
    });
  </script>
</body>
</html>